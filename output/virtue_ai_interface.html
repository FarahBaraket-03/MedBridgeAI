<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Virtue Foundation Intelligence Layer</title>
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary: #00d9ff;
            --secondary: #ff006e;
            --accent: #8338ec;
            --dark: #0f0e17;
            --light: #fffffe;
            --gray: #a7a9be;
            --success: #06ffa5;
            --warning: #ffbe0b;
        }
        
        body {
            font-family: 'DM Sans', sans-serif;
            background: var(--dark);
            color: var(--light);
            overflow-x: hidden;
        }
        
        /* Animated Background */
        .background-grid {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                linear-gradient(90deg, rgba(0, 217, 255, 0.03) 1px, transparent 1px),
                linear-gradient(rgba(0, 217, 255, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            animation: gridMove 20s linear infinite;
            pointer-events: none;
            z-index: 0;
        }
        
        @keyframes gridMove {
            0% { transform: translate(0, 0); }
            100% { transform: translate(50px, 50px); }
        }
        
        .container {
            position: relative;
            z-index: 1;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Header */
        header {
            text-align: center;
            padding: 60px 20px 40px;
            position: relative;
        }
        
        .logo {
            font-family: 'Space Mono', monospace;
            font-size: 3em;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
            animation: glow 3s ease-in-out infinite;
        }
        
        @keyframes glow {
            0%, 100% { filter: drop-shadow(0 0 20px rgba(0, 217, 255, 0.5)); }
            50% { filter: drop-shadow(0 0 40px rgba(131, 56, 236, 0.8)); }
        }
        
        .tagline {
            font-size: 1.2em;
            color: var(--gray);
            font-family: 'Space Mono', monospace;
        }
        
        .stats-bar {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .stat {
            text-align: center;
        }
        
        .stat-value {
            font-size: 2em;
            font-weight: 700;
            color: var(--primary);
            font-family: 'Space Mono', monospace;
        }
        
        .stat-label {
            font-size: 0.9em;
            color: var(--gray);
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        /* Query Interface */
        .query-section {
            background: rgba(255, 255, 254, 0.03);
            border: 2px solid var(--primary);
            border-radius: 20px;
            padding: 40px;
            margin: 40px 0;
            backdrop-filter: blur(10px);
            box-shadow: 0 20px 60px rgba(0, 217, 255, 0.1);
        }
        
        .query-header {
            font-size: 1.5em;
            margin-bottom: 20px;
            color: var(--primary);
            font-family: 'Space Mono', monospace;
        }
        
        .query-examples {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .example-chip {
            background: rgba(0, 217, 255, 0.1);
            border: 1px solid var(--primary);
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9em;
        }
        
        .example-chip:hover {
            background: var(--primary);
            color: var(--dark);
            transform: translateY(-2px);
        }
        
        .query-input-wrapper {
            position: relative;
            margin-bottom: 20px;
        }
        
        .query-input {
            width: 100%;
            padding: 20px;
            background: rgba(15, 14, 23, 0.8);
            border: 2px solid var(--gray);
            border-radius: 15px;
            color: var(--light);
            font-size: 1.1em;
            font-family: 'DM Sans', sans-serif;
            transition: all 0.3s;
        }
        
        .query-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 30px rgba(0, 217, 255, 0.3);
        }
        
        .query-submit {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border: none;
            padding: 12px 30px;
            border-radius: 10px;
            color: var(--dark);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Space Mono', monospace;
        }
        
        .query-submit:hover {
            transform: translateY(-50%) scale(1.05);
            box-shadow: 0 10px 30px rgba(0, 217, 255, 0.4);
        }
        
        /* Loading Animation */
        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }
        
        .loading.active {
            display: block;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 3px solid rgba(0, 217, 255, 0.2);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Results Section */
        .results {
            display: none;
            margin-top: 40px;
        }
        
        .results.active {
            display: block;
            animation: slideUp 0.5s ease-out;
        }
        
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .result-card {
            background: rgba(255, 255, 254, 0.05);
            border-left: 4px solid var(--primary);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
        }
        
        .result-title {
            font-size: 1.3em;
            color: var(--primary);
            margin-bottom: 15px;
            font-family: 'Space Mono', monospace;
        }
        
        .result-content {
            line-height: 1.8;
            color: var(--light);
        }
        
        .insight-badge {
            display: inline-block;
            background: var(--accent);
            color: var(--light);
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85em;
            margin-right: 8px;
            margin-bottom: 8px;
            font-family: 'Space Mono', monospace;
        }
        
        .alert-badge {
            background: var(--secondary);
        }
        
        .success-badge {
            background: var(--success);
            color: var(--dark);
        }
        
        /* Visualization Grid */
        .viz-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 30px;
            margin-top: 30px;
        }
        
        .viz-card {
            background: rgba(255, 255, 254, 0.05);
            border: 1px solid rgba(0, 217, 255, 0.2);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
        }
        
        .viz-title {
            font-size: 1.1em;
            color: var(--primary);
            margin-bottom: 15px;
            font-family: 'Space Mono', monospace;
        }
        
        #map {
            height: 500px;
            border-radius: 10px;
            margin-top: 20px;
            border: 2px solid var(--primary);
        }
        
        /* Data Table */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .data-table th {
            background: rgba(0, 217, 255, 0.1);
            color: var(--primary);
            padding: 15px;
            text-align: left;
            font-family: 'Space Mono', monospace;
            font-size: 0.9em;
        }
        
        .data-table td {
            padding: 15px;
            border-bottom: 1px solid rgba(167, 169, 190, 0.2);
        }
        
        .data-table tr:hover {
            background: rgba(0, 217, 255, 0.05);
        }
        
        /* Citations */
        .citations {
            margin-top: 30px;
            padding: 20px;
            background: rgba(131, 56, 236, 0.1);
            border-left: 3px solid var(--accent);
            border-radius: 10px;
        }
        
        .citation-title {
            font-size: 1em;
            color: var(--accent);
            margin-bottom: 10px;
            font-family: 'Space Mono', monospace;
        }
        
        .citation-item {
            font-size: 0.9em;
            color: var(--gray);
            margin: 5px 0;
            padding-left: 15px;
            position: relative;
        }
        
        .citation-item:before {
            content: "‚Üí";
            position: absolute;
            left: 0;
            color: var(--accent);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .logo {
                font-size: 2em;
            }
            
            .viz-grid {
                grid-template-columns: 1fr;
            }
            
            .query-section {
                padding: 20px;
            }
            
            .stats-bar {
                gap: 20px;
            }
        }
        
        /* Metric Cards */
        .metrics-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .metric-card {
            background: linear-gradient(135deg, rgba(0, 217, 255, 0.1), rgba(131, 56, 236, 0.1));
            border: 1px solid var(--primary);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
        }
        
        .metric-value {
            font-size: 2.5em;
            font-weight: 700;
            color: var(--primary);
            font-family: 'Space Mono', monospace;
        }
        
        .metric-label {
            font-size: 0.9em;
            color: var(--gray);
            margin-top: 5px;
        }
        
        .metric-change {
            font-size: 0.85em;
            margin-top: 5px;
        }
        
        .metric-change.positive {
            color: var(--success);
        }
        
        .metric-change.negative {
            color: var(--secondary);
        }
    </style>
</head>
<body>
    <div class="background-grid"></div>
    
    <div class="container">
        <header>
            <div class="logo">‚öï VIRTUE AI</div>
            <div class="tagline">Healthcare Intelligence Layer</div>
            <div class="stats-bar">
                <div class="stat">
                    <div class="stat-value" id="totalFacilities">797</div>
                    <div class="stat-label">Facilities</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="regionsAnalyzed">16</div>
                    <div class="stat-label">Regions</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="specialtiesTracked">45+</div>
                    <div class="stat-label">Specialties</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="gapsIdentified">127</div>
                    <div class="stat-label">Gaps Found</div>
                </div>
            </div>
        </header>
        
        <section class="query-section">
            <div class="query-header">üîç Ask About Healthcare in Ghana</div>
            
            <div class="query-examples">
                <div class="example-chip" onclick="loadExample(0)">Where are the medical deserts?</div>
                <div class="example-chip" onclick="loadExample(1)">Show cardiology capabilities</div>
                <div class="example-chip" onclick="loadExample(2)">Which regions lack emergency care?</div>
                <div class="example-chip" onclick="loadExample(3)">Compare Accra vs rural facilities</div>
                <div class="example-chip" onclick="loadExample(4)">Find hospitals with CT scanners</div>
            </div>
            
            <div class="query-input-wrapper">
                <input type="text" 
                       class="query-input" 
                       id="queryInput" 
                       placeholder="Ask me anything about healthcare facilities, specialties, equipment, or regional gaps..."
                       onkeypress="handleKeyPress(event)">
                <button class="query-submit" onclick="processQuery()">ANALYZE</button>
            </div>
        </section>
        
        <div class="loading" id="loading">
            <div class="loading-spinner"></div>
            <div style="color: var(--primary); font-family: 'Space Mono', monospace;">
                Processing query through AI intelligence layer...
            </div>
        </div>
        
        <div class="results" id="results"></div>
    </div>
    
    <script>
        const exampleQueries = [
            "Where are the medical deserts in Ghana? Show me regions with limited healthcare access.",
            "What cardiology facilities exist and where are they located?",
            "Which regions lack emergency medicine capabilities?",
            "Compare healthcare infrastructure between Accra and rural regions",
            "Find all hospitals with CT scanning equipment"
        ];
        
        // Sample data (in real implementation, this would come from your database)
        const facilitiesData = {
            total: 797,
            byRegion: {
                "Greater Accra": 312,
                "Ashanti": 156,
                "Western": 89,
                "Eastern": 67,
                "Central": 54,
                "Northern": 42,
                "Volta": 38,
                "Brong Ahafo": 39
            },
            byType: {
                "hospital": 234,
                "clinic": 421,
                "pharmacy": 87,
                "dentist": 55
            },
            specialties: {
                "internalMedicine": 489,
                "emergencyMedicine": 123,
                "cardiology": 67,
                "gynecologyAndObstetrics": 145,
                "pediatrics": 178,
                "dentistry": 92,
                "ophthalmology": 54
            },
            equipment: {
                "CT scanner": 34,
                "MRI": 12,
                "X-ray": 278,
                "Ultrasound": 312,
                "Dialysis": 45
            }
        };
        
        function loadExample(index) {
            document.getElementById('queryInput').value = exampleQueries[index];
            processQuery();
        }
        
        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                processQuery();
            }
        }
        
        function processQuery() {
            const query = document.getElementById('queryInput').value.trim();
            if (!query) return;
            
            // Show loading
            document.getElementById('loading').classList.add('active');
            document.getElementById('results').classList.remove('active');
            
            // Simulate AI processing
            setTimeout(() => {
                const results = analyzeQuery(query);
                displayResults(results);
                
                document.getElementById('loading').classList.remove('active');
                document.getElementById('results').classList.add('active');
            }, 1500);
        }
        
        function analyzeQuery(query) {
            const queryLower = query.toLowerCase();
            
            // Medical desert query
            if (queryLower.includes('desert') || queryLower.includes('gap') || queryLower.includes('lack')) {
                return generateMedicalDesertAnalysis();
            }
            
            // Cardiology query
            if (queryLower.includes('cardio')) {
                return generateCardiologyAnalysis();
            }
            
            // Emergency care query
            if (queryLower.includes('emergency')) {
                return generateEmergencyAnalysis();
            }
            
            // Comparison query
            if (queryLower.includes('compare') || queryLower.includes('vs')) {
                return generateComparisonAnalysis();
            }
            
            // Equipment query
            if (queryLower.includes('ct') || queryLower.includes('scanner') || queryLower.includes('equipment')) {
                return generateEquipmentAnalysis();
            }
            
            // Default general analysis
            return generateGeneralAnalysis(query);
        }
        
        function generateMedicalDesertAnalysis() {
            return {
                type: 'medical_desert',
                title: 'Medical Desert Analysis',
                insights: [
                    { type: 'alert', text: '5 regions identified as critical medical deserts' },
                    { type: 'alert', text: '2.3M people lack access to emergency care within 50km' },
                    { type: 'insight', text: 'Northern and Upper East regions most underserved' }
                ],
                summary: `Analysis reveals significant healthcare gaps across Ghana. The Northern, Upper East, and Upper West regions face severe medical desert conditions with patient-to-facility ratios exceeding 15,000:1. 
                
                <strong>Critical Findings:</strong>
                ‚Ä¢ Northern Region: Only 42 facilities for 2.8M people
                ‚Ä¢ Upper East: 18 facilities, 0 cardiology services
                ‚Ä¢ Upper West: 23 facilities, limited emergency capabilities
                
                These regions urgently need mobile clinics, telemedicine infrastructure, and specialist rotation programs.`,
                metrics: [
                    { label: 'Underserved Population', value: '2.3M', change: '+12%', trend: 'negative' },
                    { label: 'Critical Gaps', value: '127', change: null, trend: 'neutral' },
                    { label: 'Avg Distance to Care', value: '87km', change: '+5km', trend: 'negative' }
                ],
                visualizations: ['map', 'chart'],
                citations: [
                    'Dataset: Virtue Foundation Ghana v0.3 - 797 facilities',
                    'Analysis: Regional distribution by facility type',
                    'Source: Row-level data from Northern, Upper East, Upper West regions'
                ]
            };
        }
        
        function generateCardiologyAnalysis() {
            return {
                type: 'specialty',
                title: 'Cardiology Services Analysis',
                insights: [
                    { type: 'success', text: '67 facilities offer cardiology services' },
                    { type: 'alert', text: '85% concentrated in Greater Accra and Ashanti' },
                    { type: 'insight', text: '12 facilities have cardiac catheterization' }
                ],
                summary: `Cardiology services in Ghana show significant regional disparity. Of 67 identified cardiology facilities:
                
                <strong>Regional Distribution:</strong>
                ‚Ä¢ Greater Accra: 38 facilities (56.7%)
                ‚Ä¢ Ashanti: 19 facilities (28.4%)
                ‚Ä¢ Other regions: 10 facilities (14.9%)
                
                <strong>Advanced Capabilities:</strong>
                ‚Ä¢ Cardiac catheterization: 12 facilities
                ‚Ä¢ Echocardiography: 45 facilities
                ‚Ä¢ Holter monitoring: 23 facilities
                
                Recommendations: Establish satellite cardiology clinics in underserved regions and deploy mobile cardiac units.`,
                metrics: [
                    { label: 'Cardiology Centers', value: '67', change: '+8', trend: 'positive' },
                    { label: 'Cath Labs', value: '12', change: '+2', trend: 'positive' },
                    { label: 'Rural Access', value: '15%', change: '-3%', trend: 'negative' }
                ],
                visualizations: ['map', 'chart', 'table'],
                citations: [
                    'Dataset: 67 facilities with cardiology specialty tag',
                    'Equipment data: procedure and capability fields',
                    'Source: Rows 35, 87, 145, 223, 387 (sample citations)'
                ]
            };
        }
        
        function generateEmergencyAnalysis() {
            return {
                type: 'specialty',
                title: 'Emergency Medicine Capabilities',
                insights: [
                    { type: 'alert', text: 'Only 123 facilities offer emergency services (15.4%)' },
                    { type: 'alert', text: '6 regions have <10 emergency facilities' },
                    { type: 'success', text: '24/7 emergency care available in 89 facilities' }
                ],
                summary: `Emergency medicine infrastructure shows critical gaps across Ghana. Only 123 of 797 facilities (15.4%) offer emergency services.
                
                <strong>24/7 Emergency Coverage:</strong>
                ‚Ä¢ Greater Accra: 45 facilities
                ‚Ä¢ Ashanti: 23 facilities
                ‚Ä¢ Western: 8 facilities
                ‚Ä¢ Northern: 4 facilities (CRITICAL GAP)
                
                <strong>Response Time Analysis:</strong>
                ‚Ä¢ Urban areas: <30 min average
                ‚Ä¢ Rural areas: 90+ min average
                ‚Ä¢ Medical deserts: 3+ hours
                
                Immediate action needed: Deploy emergency medical services to Northern, Upper regions, and establish trauma protocols.`,
                metrics: [
                    { label: 'Emergency Facilities', value: '123', change: '+5', trend: 'positive' },
                    { label: 'Rural Coverage', value: '18%', change: '-2%', trend: 'negative' },
                    { label: 'Trauma Centers', value: '8', change: null, trend: 'neutral' }
                ],
                visualizations: ['map', 'chart'],
                citations: [
                    'Dataset: 123 facilities tagged with emergencyMedicine',
                    'Capability analysis: 24/7 service indicators',
                    'Source: capability field row-level extraction'
                ]
            };
        }
        
        function generateComparisonAnalysis() {
            return {
                type: 'comparison',
                title: 'Urban vs Rural Healthcare Infrastructure',
                insights: [
                    { type: 'alert', text: '8x disparity in facility density' },
                    { type: 'insight', text: 'Accra has 312 facilities, Northern has 42' },
                    { type: 'alert', text: 'Specialist care virtually absent in rural areas' }
                ],
                summary: `Comparative analysis reveals stark urban-rural healthcare divide:
                
                <strong>Greater Accra (Population: 4.7M):</strong>
                ‚Ä¢ 312 facilities (1 per 15,000 people)
                ‚Ä¢ 45 specialty hospitals
                ‚Ä¢ 38 cardiology centers
                ‚Ä¢ Advanced equipment: 18 CT, 7 MRI
                
                <strong>Northern Region (Population: 2.8M):</strong>
                ‚Ä¢ 42 facilities (1 per 67,000 people)
                ‚Ä¢ 3 specialty hospitals
                ‚Ä¢ 2 cardiology centers
                ‚Ä¢ Advanced equipment: 1 CT, 0 MRI
                
                This 4.5x population-adjusted disparity represents a systemic failure requiring immediate policy intervention.`,
                metrics: [
                    { label: 'Accra Facilities', value: '312', change: null, trend: 'neutral' },
                    { label: 'Northern Facilities', value: '42', change: null, trend: 'neutral' },
                    { label: 'Disparity Ratio', value: '7.4x', change: '+0.3x', trend: 'negative' }
                ],
                visualizations: ['chart', 'table'],
                citations: [
                    'Dataset: Regional grouping of all 797 facilities',
                    'Population data: Ghana Statistical Service 2021',
                    'Analysis: address_stateOrRegion field aggregation'
                ]
            };
        }
        
        function generateEquipmentAnalysis() {
            return {
                type: 'equipment',
                title: 'Advanced Medical Equipment Distribution',
                insights: [
                    { type: 'success', text: '34 facilities have CT scanners' },
                    { type: 'alert', text: 'Only 12 MRI machines nationwide' },
                    { type: 'insight', text: '91% of imaging equipment in 2 regions' }
                ],
                summary: `Medical equipment analysis reveals extreme concentration of advanced diagnostic tools:
                
                <strong>CT Scanners (34 total):</strong>
                ‚Ä¢ Greater Accra: 18 (52.9%)
                ‚Ä¢ Ashanti: 13 (38.2%)
                ‚Ä¢ Other regions: 3 (8.8%)
                
                <strong>MRI Machines (12 total):</strong>
                ‚Ä¢ Greater Accra: 7 (58.3%)
                ‚Ä¢ Ashanti: 4 (33.3%)
                ‚Ä¢ Other regions: 1 (8.3%)
                
                <strong>Impact:</strong> Patients in rural areas must travel 200+ km for advanced imaging, creating diagnostic delays and treatment gaps.
                
                Recommendations: Establish regional imaging centers and mobile diagnostic units.`,
                metrics: [
                    { label: 'CT Scanners', value: '34', change: '+3', trend: 'positive' },
                    { label: 'MRI Machines', value: '12', change: '+1', trend: 'positive' },
                    { label: 'Rural Access', value: '9%', change: null, trend: 'negative' }
                ],
                visualizations: ['map', 'chart', 'table'],
                citations: [
                    'Dataset: equipment field text extraction',
                    'Keywords: "CT scanner", "MRI", "Siemens", "GE"',
                    'Source: 34 facility records with imaging equipment'
                ]
            };
        }
        
        function generateGeneralAnalysis(query) {
            return {
                type: 'general',
                title: 'Healthcare Infrastructure Overview',
                insights: [
                    { type: 'insight', text: '797 facilities across 16 regions' },
                    { type: 'success', text: '489 facilities offer internal medicine' },
                    { type: 'alert', text: 'Significant regional disparities identified' }
                ],
                summary: `General healthcare infrastructure analysis for Ghana:
                
                <strong>Facility Distribution:</strong>
                ‚Ä¢ Hospitals: 234 (29.4%)
                ‚Ä¢ Clinics: 421 (52.8%)
                ‚Ä¢ Pharmacies: 87 (10.9%)
                ‚Ä¢ Dental: 55 (6.9%)
                
                <strong>Top Specialties:</strong>
                ‚Ä¢ Internal Medicine: 489 facilities
                ‚Ä¢ Pediatrics: 178 facilities
                ‚Ä¢ Gynecology/Obstetrics: 145 facilities
                ‚Ä¢ Emergency Medicine: 123 facilities
                
                Your query: "${query}"
                
                For more specific insights, try asking about: medical deserts, specific specialties, equipment, or regional comparisons.`,
                metrics: [
                    { label: 'Total Facilities', value: '797', change: null, trend: 'neutral' },
                    { label: 'Regions Covered', value: '16', change: null, trend: 'neutral' },
                    { label: 'Avg Facilities/Region', value: '50', change: null, trend: 'neutral' }
                ],
                visualizations: ['chart'],
                citations: [
                    'Dataset: Virtue Foundation Ghana v0.3',
                    'Analysis: Full dataset aggregation',
                    'Source: All 797 facility records'
                ]
            };
        }
        
        function displayResults(results) {
            const resultsDiv = document.getElementById('results');
            
            let html = `
                <div class="result-card">
                    <div class="result-title">${results.title}</div>
                    
                    <div style="margin: 20px 0;">
                        ${results.insights.map(insight => `
                            <span class="insight-badge ${insight.type === 'alert' ? 'alert-badge' : insight.type === 'success' ? 'success-badge' : ''}">${insight.text}</span>
                        `).join('')}
                    </div>
                    
                    <div class="result-content">${results.summary}</div>
                    
                    ${results.metrics ? `
                        <div class="metrics-row">
                            ${results.metrics.map(metric => `
                                <div class="metric-card">
                                    <div class="metric-value">${metric.value}</div>
                                    <div class="metric-label">${metric.label}</div>
                                    ${metric.change ? `<div class="metric-change ${metric.trend}">${metric.change}</div>` : ''}
                                </div>
                            `).join('')}
                        </div>
                    ` : ''}
                </div>
            `;
            
            // Add visualizations
            if (results.visualizations.includes('chart')) {
                html += `
                    <div class="viz-grid">
                        <div class="viz-card">
                            <div class="viz-title">üìä Regional Distribution</div>
                            <canvas id="regionChart"></canvas>
                        </div>
                        <div class="viz-card">
                            <div class="viz-title">üè• Facility Types</div>
                            <canvas id="typeChart"></canvas>
                        </div>
                    </div>
                `;
            }
            
            if (results.visualizations.includes('map')) {
                html += `
                    <div class="result-card">
                        <div class="result-title">üó∫Ô∏è Geographic Distribution</div>
                        <div id="map"></div>
                    </div>
                `;
            }
            
            if (results.visualizations.includes('table')) {
                html += `
                    <div class="result-card">
                        <div class="result-title">üìã Detailed Breakdown</div>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Region</th>
                                    <th>Facilities</th>
                                    <th>Population</th>
                                    <th>Ratio</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Greater Accra</td>
                                    <td>312</td>
                                    <td>4.7M</td>
                                    <td>1:15,000</td>
                                    <td style="color: var(--success)">‚úì Adequate</td>
                                </tr>
                                <tr>
                                    <td>Ashanti</td>
                                    <td>156</td>
                                    <td>5.4M</td>
                                    <td>1:34,600</td>
                                    <td style="color: var(--warning)">‚ö† Moderate</td>
                                </tr>
                                <tr>
                                    <td>Northern</td>
                                    <td>42</td>
                                    <td>2.8M</td>
                                    <td>1:67,000</td>
                                    <td style="color: var(--secondary)">‚úó Critical</td>
                                </tr>
                                <tr>
                                    <td>Upper East</td>
                                    <td>18</td>
                                    <td>1.2M</td>
                                    <td>1:67,000</td>
                                    <td style="color: var(--secondary)">‚úó Critical</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                `;
            }
            
            // Add citations
            html += `
                <div class="citations">
                    <div class="citation-title">üìö Data Sources & Citations</div>
                    ${results.citations.map(citation => `
                        <div class="citation-item">${citation}</div>
                    `).join('')}
                </div>
            `;
            
            resultsDiv.innerHTML = html;
            
            // Initialize charts if needed
            if (results.visualizations.includes('chart')) {
                setTimeout(createCharts, 100);
            }
            
            // Initialize map if needed
            if (results.visualizations.includes('map')) {
                setTimeout(createMap, 100);
            }
        }
        
        function createCharts() {
            // Regional chart
            const regionCtx = document.getElementById('regionChart');
            if (regionCtx) {
                new Chart(regionCtx, {
                    type: 'bar',
                    data: {
                        labels: Object.keys(facilitiesData.byRegion),
                        datasets: [{
                            label: 'Number of Facilities',
                            data: Object.values(facilitiesData.byRegion),
                            backgroundColor: 'rgba(0, 217, 255, 0.6)',
                            borderColor: 'rgba(0, 217, 255, 1)',
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        plugins: {
                            legend: { display: false }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: { color: '#a7a9be' },
                                grid: { color: 'rgba(167, 169, 190, 0.1)' }
                            },
                            x: {
                                ticks: { color: '#a7a9be' },
                                grid: { display: false }
                            }
                        }
                    }
                });
            }
            
            // Type chart
            const typeCtx = document.getElementById('typeChart');
            if (typeCtx) {
                new Chart(typeCtx, {
                    type: 'doughnut',
                    data: {
                        labels: Object.keys(facilitiesData.byType),
                        datasets: [{
                            data: Object.values(facilitiesData.byType),
                            backgroundColor: [
                                'rgba(0, 217, 255, 0.8)',
                                'rgba(131, 56, 236, 0.8)',
                                'rgba(255, 0, 110, 0.8)',
                                'rgba(6, 255, 165, 0.8)'
                            ],
                            borderWidth: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: { color: '#a7a9be' }
                            }
                        }
                    }
                });
            }
        }
        
        function createMap() {
            const map = L.map('map').setView([7.9465, -1.0232], 7);
            
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '¬© OpenStreetMap contributors'
            }).addTo(map);
            
            // Sample facility markers (in real implementation, use actual coordinates)
            const facilities = [
                { name: "Korle Bu Teaching Hospital", lat: 5.5431, lng: -0.2273, type: "hospital", specialty: "Multi-specialty" },
                { name: "Ridge Hospital", lat: 5.5600, lng: -0.1969, type: "hospital", specialty: "Emergency" },
                { name: "37 Military Hospital", lat: 5.5891, lng: -0.1848, type: "hospital", specialty: "Military" },
                { name: "Komfo Anokye Teaching Hospital", lat: 6.6885, lng: -1.6244, type: "hospital", specialty: "Multi-specialty" },
                { name: "Tamale Teaching Hospital", lat: 9.4034, lng: -0.8424, type: "hospital", specialty: "Regional" }
            ];
            
            facilities.forEach(facility => {
                const marker = L.marker([facility.lat, facility.lng])
                    .bindPopup(`<b>${facility.name}</b><br>Type: ${facility.type}<br>Specialty: ${facility.specialty}`)
                    .addTo(map);
            });
        }
    </script>
</body>
</html>